<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ringmaster Viewer</title>
    <meta
      name="description"
      content="Ringmaster - CLI package for testing websites & checking their contents"
    />
    <meta name="author" content="Gerrproger" />

    <link
      rel="icon"
      href="https://raw.githubusercontent.com/Gerrproger/ringmaster/main/ringmaster-logo.png"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,600"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,500,0,0"
    />

    <style>
      *,
      ::before,
      ::after {
        box-sizing: border-box;
      }

      html,
      body {
        padding: 0;
        margin: 0;
        height: 100%;
      }

      html {
        --color-trans-2: rgba(255, 255, 255, 0.2);
        --color-trans-4: rgba(255, 255, 255, 0.4);
        --color-trans-6: rgba(255, 255, 255, 0.6);
        --color-trans-8: rgba(255, 255, 255, 0.8);
        --color-trans-inv-2: rgba(0, 0, 0, 0.2);
        --color-trans-inv-4: rgba(0, 0, 0, 0.4);
        --color-trans-inv-6: rgba(0, 0, 0, 0.6);
        --color-trans-inv-8: rgba(0, 0, 0, 0.8);
        --color-dark: #000;
        --color-font: #fff;
        --color-font-dimmed: #ccc;
        --color-bg: #2b2b2b;
        --color-bg-2: #1e1e1e;
        --color-bg-3: #404040;
        --color-warn: #f1a3a3;
        --color-info: #a3a3f1;
        --color-success: #8dee8d;
        --color-dimmed: #a5a5a5;
        --border-separator: 0.1rem solid var(--color-trans-2);
        --transition: 0.2s ease-out;
        font-size: 16px;
      }

      body {
        font-family: roboto mono, monospace;
        display: flex;
        flex-direction: column;
        color: var(--color-font);
        background: var(--color-bg);
        cursor: default;
      }

      .wrapper {
        margin: 0 auto;
        max-width: 1200px;
        padding: 0 2rem;
      }

      header {
        padding: 1rem 0;
        background: var(--color-bg-2);
        border-bottom: var(--border-separator);
      }

      main {
        flex: 1;
        overflow-x: auto;
        overflow-y: scroll;
        scrollbar-gutter: stable both-edges;
        scroll-behavior: smooth;
        scrollbar-color: var(--color-bg-3) var(--color-dark);
      }

      main::-webkit-scrollbar {
        width: 0.8rem;
      }

      main::-webkit-scrollbar-track {
        background: var(--color-dark);
      }

      main::-webkit-scrollbar-thumb {
        background-color: var(--color-bg-3);
      }

      footer {
        background: var(--color-bg-3);
        border-top: var(--border-separator);
      }

      .button,
      button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 0 0 0.6rem 0.6rem;
        padding: 0.2rem 0.4rem;
        font: inherit;
        font-size: 0.8rem;
        text-decoration: none;
        border-radius: 0;
        border: none;
        border-top: 0.1rem solid var(--color-bg-2);
        border-left: 0.1rem solid var(--color-bg-2);
        border-bottom: 0.1rem solid var(--color-trans-4);
        border-right: 0.1rem solid var(--color-trans-4);
        color: var(--color-font);
        background: var(--color-bg-2);
        cursor: pointer;
        transition: border var(--transition), transform var(--transition),
          color var(--transition);
      }

      .button_big {
        padding: 0.5rem 1.2rem;
        line-height: 1.5;
      }

      .button_big.icon::before {
        margin-left: -0.2rem;
        margin-right: 0.6rem;
        font-size: 1.5rem;
      }

      .button_dimmed {
        color: var(--color-font-dimmed);
      }

      .button:first-child,
      button:first-child {
        margin-left: 0;
      }

      .button:hover,
      .button:focus,
      button:hover,
      button:focus {
        border-bottom-color: var(--color-trans-6);
        border-right-color: var(--color-trans-6);
        transform: translateY(-0.2rem);
      }

      .button:active,
      button:active {
        transform: none;
      }

      h1 {
        font-size: 1.2rem;
        padding: 0;
        margin: 0;
      }

      b {
        font-weight: 500;
      }

      .flex {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .start {
        justify-content: flex-start;
      }

      .wrap {
        flex-wrap: wrap;
      }

      .column {
        flex-direction: column;
        align-items: start;
      }

      .no-shrink {
        flex-shrink: 0;
      }

      .label {
        font-size: 0.7rem;
        color: var(--color-trans-6);
      }

      .label_main {
        color: var(--color-trans-8);
      }

      .title {
        font-size: 1.1rem;
        font-weight: 600;
      }

      .subtitle {
        font-size: 0.9rem;
        font-weight: 600;
      }

      .small {
        font-size: 0.7rem;
      }

      .row {
        margin: 0 -1rem;
      }

      .col {
        padding: 0 1rem;
        overflow: hidden;
      }

      .text-right {
        text-align: right;
      }

      .ma-0 {
        margin: 0 !important;
      }

      .wm-50 {
        max-width: 50% !important;
      }

      .warn {
        color: var(--color-warn);
      }

      .dimmed {
        color: var(--color-dimmed);
      }

      .info {
        color: var(--color-info);
      }

      .success {
        color: var(--color-success);
      }

      .header__info {
        font-size: 0.8rem;
        color: var(--color-trans-8);
        display: none;
      }

      .ready .header__info {
        display: block;
      }

      .message {
        margin: 1rem 0;
        padding: 1rem;
        padding-left: 0;
        border: 0.2rem solid var(--color-trans-inv-4);
        border-left-color: transparent;
        border-top-color: transparent;
      }

      .error .not-ready,
      .ready .not-ready {
        display: none;
      }

      .load-error {
        display: none;
      }

      .error .load-error {
        display: block;
      }

      .suits {
        display: none;
      }

      .ready .suits {
        display: block;
      }

      .suit {
        position: relative;
        transition: padding var(--transition);
      }

      .suit:last-child,
      .suit_opened {
        padding-bottom: 3rem;
      }

      .suit__header {
        position: sticky;
        z-index: 50;
        top: 0;
        min-height: 6rem;
        padding: 1rem 0;
        font-size: 0.8rem;
        background: var(--color-bg);
      }

      .suit__header:target .hash {
        color: var(--color-success);
      }

      .suit__name {
        user-select: none;
        cursor: pointer;
      }

      .suit__name:hover::before,
      .suit__name:focus::before {
        color: var(--color-trans-8);
      }

      .separated::after {
        content: '';
        position: absolute;
        left: 1rem;
        right: 1rem;
        bottom: 0;
        border-bottom: var(--border-separator);
      }

      .suit__cases {
        padding-top: 1rem;
        border: var(--border-separator);
        border-top: none;
        display: none;
      }

      .suit_opened .suit__cases {
        display: block;
      }

      .cases {
        font-size: 0.8rem;
        margin: 0 1rem 1rem;
        padding: 0 1rem 1rem 1rem;
        background: var(--color-bg-2);
      }

      .cases__header {
        position: sticky;
        z-index: 30;
        top: 6.6rem;
        padding: 1rem 0;
        background: var(--color-bg-2);
      }

      .cases__header::before {
        content: '';
        position: absolute;
        top: -1rem;
        height: 1rem;
        left: 0;
        right: 0;
        background: var(--color-bg);
      }

      .cases__header + * {
        margin-top: 1rem;
      }

      .result__content {
        transition: background var(--transition);
      }

      .result__content:hover,
      .result__content:focus {
        background: var(--color-bg-3);
      }

      .result__content_aggregated {
        padding-top: 1rem;
        padding-bottom: 1rem;
        align-items: start;
      }

      .result__content_opened {
        background: transparent !important;
      }

      .controls {
        margin-left: auto;
        padding-top: 1rem;
        padding-bottom: 0.4rem;
      }

      .result__content_aggregated > .controls {
        position: sticky;
        top: 12rem;
      }

      .controls.aggregated-info {
        padding-top: 0.6rem;
        padding-bottom: 0;
      }

      .icon::before {
        font-family: 'Material Symbols Sharp';
        font-size: 0.8rem;
        letter-spacing: 0.4rem;
        line-height: 1;
        font-weight: normal;
        font-style: normal;
        text-transform: none;
        white-space: nowrap;
        word-wrap: normal;
        direction: ltr;
        -webkit-font-feature-settings: 'liga';
        -webkit-font-smoothing: antialiased;
        display: none;
        transition: color var(--transition), transform var(--transition);
      }

      .ready .icon::before {
        display: inline-block;
      }

      .icon_show::before {
        content: '\e8f4';
      }

      .icon_hide::before {
        content: '\e8f5';
      }

      .icon_expand::before {
        content: '\e5d7';
      }

      .icon_collapse::before {
        content: '\e5d6';
      }

      .icon_up::before {
        content: '\e5ce';
      }

      .icon_down::before {
        content: '\e5cf';
      }

      .icon_list_aggregated::before {
        content: '\e241';
      }

      .icon_list_normal::before {
        content: '\e8ef';
      }

      .icon_chevron::before {
        content: '\e7cd';
        font-size: 2.2rem;
        color: var(--color-trans-4);
        transform-origin: 1.1rem 1.1rem;
        transform: rotate(-90deg);
      }

      .suit_opened .icon_chevron::before {
        transform: none;
      }

      .aggregated-result {
        padding-top: 0.2rem;
        padding-right: 0.2rem;
      }

      .aggregated-result_details {
        display: flex;
        transition: background var(--transition);
      }

      .aggregated-result_details:hover,
      .aggregated-result_details:focus {
        background: var(--color-bg-3);
      }

      .aggregated-info {
        display: none;
      }

      .aggregated-result_details .aggregated-info {
        display: inline;
      }
    </style>
  </head>
  <body v-scope @vue:mounted="ready" :class="{ ready }">
    <header>
      <div class="wrapper flex">
        <h1>Ringmaster Viewer</h1>
        <div class="header__info">
          <b>Generated: </b><i>{{buildDate ? prettyDate(buildDate) : '?'}}</i>
        </div>
      </div>
    </header>
    <main>
      <div v-if="!ready" class="wrapper load-error">
        <div class="message warn">Failed to load script!</div>
      </div>

      <div v-if="!ready" class="wrapper not-ready">
        <div class="message info">Loading...</div>
      </div>

      <div class="wrapper suits">
        <div v-if="!suits.length" class="message warn">
          No Test Suits found!
        </div>

        <div
          v-for="suit in suits"
          class="suit"
          :class="{ suit_opened: suit._opened }"
        >
          <div
            class="suit__header flex row start separated"
            :id="suitId(suit).id"
          >
            <div class="col no-shrink">
              <div
                class="suit__name flex icon icon_chevron"
                title="Show/hide test results"
                tabindex="0"
                role="button"
                :aria-pressed="suit._opened"
                @keydown="toggleSuit(suit, $event)"
                @click="toggleSuit(suit)"
              >
                <div>
                  <div class="label label_main">Suit name:</div>
                  <div class="title">{{suit.name || '?'}}</div>
                </div>
              </div>
            </div>

            <div v-if="!suit._dirsShown && !suit._errorShown" class="col">
              <div class="label">Host:</div>
              <div>{{suit.host || '?'}}</div>
            </div>

            <div
              v-if="!suit._dirsShown && !suit._errorShown && !aggregated"
              class="col"
            >
              <div class="label">Time spent:</div>
              <div>{{suit.timeSpent || '?'}} sec</div>
            </div>

            <div
              v-if="!suit._dirsShown && !suit._errorShown && !aggregated"
              class="col"
            >
              <div class="label">Date:</div>
              <div>{{suit.date ? prettyDate(suit.date) : '?'}}</div>
            </div>

            <div v-if="suit._dirsShown" class="col">
              <div class="label info">Directories:</div>
              <div>
                <span class="label small">Input dir:</span>
                <span class="small">"{{suit.inputDir || '?'}}"</span>
              </div>
              <div>
                <span class="label small">Output dir:</span>
                <span class="small">"{{suit.outputDir || '?'}}"</span>
              </div>
            </div>

            <div v-if="suit._errorShown" class="col">
              <div class="label warn">Error:</div>
              <div>{{suit.error || '?'}}</div>
            </div>

            <div class="col controls no-shrink">
              <button
                v-if="!suit._errorShown && suit.error"
                @click="suit._errorShown=true;suit._dirsShown=false;"
                class="warn"
              >
                Show Error
              </button>
              <button
                v-if="suit._errorShown"
                @click="suit._errorShown=false;"
                class="warn"
              >
                Hide Error
              </button>

              <button
                v-if="!suit._dirsShown && !aggregated"
                @click="suit._dirsShown=true;suit._errorShown=false;"
                class="info"
              >
                Show Directories
              </button>
              <button
                v-if="suit._dirsShown"
                @click="suit._dirsShown=false;"
                class="info"
              >
                Hide Directories
              </button>

              <a
                v-if="suit.sourceFile"
                class="button"
                target="_blank"
                :href="suit.sourceFile"
              >
                Open Source
              </a>

              <a v-if="suit.id" class="button hash" :href="suitId(suit).hash"
                >#</a
              >
            </div>
          </div>

          <div class="suit__cases">
            <div v-if="!suit.cases.length" class="message warn">
              No Test Cases found!
            </div>

            <div v-for="cases in suit.cases" class="cases">
              <div class="cases__header flex row start separated">
                <div class="col no-shrink">
                  <span class="label label_main">Type:</span>
                  <span class="subtitle">{{cases.type || '?'}}</span>
                </div>

                <div v-if="cases.error" class="col">
                  <span class="label warn">Error:</span>
                  <span>{{cases.error || '?'}}</span>
                </div>
              </div>

              <div v-if="!cases.results.length" class="message dimmed">
                No Test Results found
              </div>

              <div v-for="result in cases.results" class="result">
                <div
                  v-scope="{hack: 0}"
                  v-effect="result._detailsShown && hack++;"
                  class="result__content flex row start"
                  :class="{'result__content_opened': result._detailsShown, 'result__content_aggregated': aggregated, dumb: hack}"
                >
                  <div v-if="aggregated" class="col no-shrink wm-50">
                    <div>{{result.name}}</div>

                    <div
                      class="flex start wrap"
                      :class="{column: result._detailsShown}"
                    >
                      <div
                        v-for="item of result.aggregated"
                        class="aggregated-result row flex"
                        :class="{'aggregated-result_details': result._detailsShown}"
                      >
                        <div class="col">
                          <div v-if="item.success" class="small success">
                            ✔<span class="aggregated-info"> Success</span>
                          </div>
                          <div v-else class="small warn">
                            ✘<span class="aggregated-info"> Failed</span>
                          </div>

                          <div class="label small aggregated-info">
                            {{item.date ? prettyDate(item.date) : '?'}}
                          </div>
                        </div>

                        <div class="col aggregated-info controls">
                          <a
                            v-if="cases.type === 'visual'"
                            :href="item.screenshot"
                            target="_blank"
                            class="button small info"
                          >
                            Open Screenshot
                          </a>
                          <a
                            v-if="item.sourceFile"
                            class="button button_dimmed small"
                            target="_blank"
                            :href="item.sourceFile"
                          >
                            Open Source
                          </a>

                          <a
                            v-if="item.suitId"
                            class="button button_dimmed small"
                            target="_blank"
                            :href="suitId(item, 'suitId').hash"
                            >Open Test</a
                          >
                        </div>
                      </div>
                    </div>
                  </div>

                  <div v-else class="col no-shrink">
                    <div>{{result.name}}</div>

                    <div v-if="result.success" class="small success">
                      ✔ Success
                    </div>
                    <div v-else class="small warn">✘ Failed</div>
                  </div>

                  <div v-if="result._selectorShown" class="col">
                    <span class="label info">Selector:</span>
                    <span>"{{result.selector || '?'}}"</span>
                  </div>

                  <div v-if="result._errorShown" class="col">
                    <span class="label warn">Error:</span>
                    <span>{{result.error || '?'}}</span>
                  </div>

                  <div class="col controls no-shrink">
                    <button
                      v-if="!result._errorShown && result.error"
                      @click="result._errorShown=true;result._selectorShown=false;"
                      class="small warn"
                    >
                      Show Error
                    </button>
                    <button
                      v-if="result._errorShown"
                      @click="result._errorShown=false;"
                      class="small warn"
                    >
                      Hide Error
                    </button>

                    <button
                      v-if="cases.type === 'selectors' && !result._selectorShown"
                      @click="result._selectorShown=true;result._errorShown=false;result._detailsShown=false;"
                      class="small info"
                    >
                      Show Selector
                    </button>
                    <button
                      v-if="cases.type === 'selectors' && result._selectorShown"
                      @click="result._selectorShown=false;"
                      class="small info"
                    >
                      Hide Selector
                    </button>
                    <a
                      v-if="cases.type === 'visual' && !aggregated"
                      :href="result.screenshot"
                      target="_blank"
                      class="button small info"
                    >
                      Open Screenshot
                    </a>

                    <button
                      v-scope="{hack: 0}"
                      v-if="!result._detailsShown && aggregated"
                      @click="result._detailsShown=true;result._selectorShown=false;hack++;"
                      class="small"
                    >
                      Show Details
                    </button>
                    <button
                      v-if="result._detailsShown"
                      @click="result._detailsShown=false;"
                      class="small"
                    >
                      Hide Details
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="wrapper">
        <div class="row flex">
          <div class="controls ma-0 col">
            <button
              @click="switchView"
              class="button_big icon"
              :class="{icon_list_normal: aggregated, icon_list_aggregated: !aggregated}"
            >
              <div class="flex column">
                <span>Switch to</span>
                <span v-if="aggregated">Normal view</span>
                <span v-else>Aggregate view</span>
              </div>
            </button>
          </div>

          <div class="controls text-right col">
            <div>
              <button
                v-if="!aggregated"
                @click="sortDate"
                class="icon"
                :class="{icon_up: !sortDateReverse, icon_down: sortDateReverse}"
              >
                Sort Suits by Date
              </button>
              <button
                @click="sortName"
                class="icon"
                :class="{icon_up: !sortNameReverse, icon_down: sortNameReverse}"
              >
                Sort Suits by Name
              </button>

              <button @click="openCases" class="success icon icon_expand">
                Expand Test Cases
              </button>
              <button @click="closeCases" class="success icon icon_collapse">
                Collapse Test Cases
              </button>
            </div>

            <div v-if="!aggregated">
              <button @click="showDirs" class="info icon icon_show">
                Show Suit Directories
              </button>
              <button @click="hideDirs" class="info icon icon_hide">
                Hide Suit Directories
              </button>

              <button @click="showErrors" class="warn icon icon_show">
                Show Suit Errors
              </button>
              <button @click="hideErrors" class="warn icon icon_hide">
                Hide Suit Errors
              </button>
            </div>

            <div v-else>
              <button
                @click="sortResultsDate"
                class="icon"
                :class="{icon_up: !sortResultsDateReverse, icon_down: sortResultsDateReverse}"
              >
                Sort Results by Date
              </button>
              <button
                @click="sortResultsSuccess"
                class="icon"
                :class="{icon_up: !sortResultsSuccessReverse, icon_down: sortResultsSuccessReverse}"
              >
                Sort Results by Success
              </button>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script type="module">
      import { createApp } from 'https://unpkg.com/petite-vue?module';

      const buildDate = null;
      const suitsList = [];

      const mainBlock = document.querySelector('main');

      createApp({
        suits: [],
        buildDate,
        ready: false,
        sortDateReverse: false,
        sortNameReverse: false,
        sortResultsDateReverse: false,
        sortResultsSuccessReverse: false,
        aggregated: false,

        ready() {
          this.ready = true;
          this.setSuits();
          this.scrollMain();
        },

        suitId(suit, key = 'id') {
          const id = suit[key] ? `suit:${suit[key]}` : '';
          return {
            id,
            hash: `#${id}`,
          };
        },

        switchView() {
          this.aggregated = !this.aggregated;
          this.setSuits();
        },

        setSuits() {
          this.sortDateReverse = false;
          this.sortNameReverse = false;
          this.sortResultsDateReverse = false;
          this.sortResultsSuccessReverse = false;
          this.suits = this.aggregated ? this.aggregatedView : this.normalView;
          this.aggregated ? this.sortName() : this.sortDate();
          this.sortResultsDate();
        },

        get normalView() {
          return suitsList.map((suit) => {
            suit._opened = true;
            suit._dirsShown = false;
            suit._errorShown = false;

            for (const cases of suit.cases) {
              cases.results = cases.results.map((result) => {
                if (cases.type === 'selectors') {
                  result._selectorShown = false;
                }
                result._errorShown = false;

                return result;
              });
            }

            return suit;
          });
        },

        get aggregatedView() {
          const makeArray = (obj) => Object.values(obj);
          const suits = {};

          for (const suit of suitsList) {
            const suitKey = `${suit.name}_${suit.host}`;

            if (!suits[suitKey]) {
              suits[suitKey] = {
                host: suit.host,
                name: suit.name,
                _opened: true,
                cases: {},
              };
            }

            for (const cases of suit.cases) {
              if (!suits[suitKey].cases[cases.type]) {
                suits[suitKey].cases[cases.type] = {
                  type: cases.type,
                  results: {},
                };
              }

              for (const result of cases.results) {
                const resultKey = `${result.name}_${result.selector}`;

                if (!suits[suitKey].cases[cases.type].results[resultKey]) {
                  suits[suitKey].cases[cases.type].results[resultKey] = {
                    name: result.name,
                    selector: result.selector,
                    _detailsShown: false,
                    aggregated: [],
                  };
                }

                suits[suitKey].cases[cases.type].results[
                  resultKey
                ].aggregated.push({
                  success: result.success,
                  error: result.error,
                  screenshot: result.screenshot,
                  date: suit.date,
                  suitId: suit.id,
                  inputDir: suit.inputDir,
                  outputDir: suit.outputDir,
                  sourceFile: suit.sourceFile,
                });
              }
            }
          }

          const ret = makeArray(suits);

          for (const suit of ret) {
            suit.cases = makeArray(suit.cases);

            for (const casesType of suit.cases) {
              casesType.results = makeArray(casesType.results);
            }
          }

          return ret;
        },

        scrollMain() {
          const hash = location.hash;

          setTimeout(() => {
            if (hash.length > 1) {
              const hashBlock = document.querySelector(
                hash.replace(/:/g, '\\:')
              );
              hashBlock && hashBlock.scrollIntoView();
              return;
            }

            mainBlock.scrollTop = sessionStorage.getItem('scrollPos') || 0;
          }, 0);
        },

        toggleSuit(suit, e) {
          if (e && ![13, 32].includes(e.keyCode)) {
            return;
          }

          e && e.preventDefault();

          suit._opened = !suit._opened;
        },

        loopResults(callback) {
          for (const suit of this.suits) {
            for (const cases of suit.cases) {
              for (const result of cases.results) {
                callback(result);
              }
            }
          }
        },

        sortDate() {
          this.sortDateReverse = !this.sortDateReverse;
          this.doSort(this.suits, 'date', this.sortDateReverse);
        },
        sortName() {
          this.sortNameReverse = !this.sortNameReverse;
          this.doSort(this.suits, 'name', this.sortNameReverse);
        },

        sortResultsDate() {
          if (!this.aggregated) {
            return;
          }

          this.sortResultsDateReverse = !this.sortResultsDateReverse;

          this.loopResults((result) => {
            this.doSort(result.aggregated, 'date', this.sortResultsDateReverse);
          });
        },
        sortResultsSuccess() {
          if (!this.aggregated) {
            return;
          }

          this.sortResultsSuccessReverse = !this.sortResultsSuccessReverse;

          this.loopResults((result) => {
            this.doSort(
              result.aggregated,
              'success',
              this.sortResultsSuccessReverse
            );
          });
        },

        doSort(obj, key, reverse) {
          obj.sort((a, b) => {
            const left = a[key].toString().toLowerCase();
            const right = b[key].toString().toLowerCase();

            if (left < right) {
              return reverse ? 1 : -1;
            }

            if (left > right) {
              return reverse ? -1 : 1;
            }

            return 0;
          });
        },

        showDirs() {
          this.suits.forEach((suit) => {
            suit._dirsShown = true;
            suit._errorShown = false;
          });
        },
        hideDirs() {
          this.suits.forEach((suit) => {
            suit._dirsShown = false;
          });
        },

        showErrors() {
          this.suits.forEach((suit) => {
            suit._errorShown = true;
            suit._dirsShown = false;
          });
        },
        hideErrors() {
          this.suits.forEach((suit) => {
            suit._errorShown = false;
          });
        },

        openCases() {
          this.suits.forEach((suit) => {
            suit._opened = true;
          });
        },
        closeCases() {
          this.suits.forEach((suit) => {
            suit._opened = false;
          });
        },

        prettyDate(str) {
          return new Date(str).toLocaleString();
        },
      }).mount();

      window.addEventListener('beforeunload', () => {
        sessionStorage.setItem('scrollPos', mainBlock.scrollTop);
      });
    </script>
    <script type="module">
      const bodyClass = document.body.classList;
      if (!bodyClass.contains('ready')) {
        bodyClass.add('error');
      }
    </script>
  </body>
</html>
